# Инструкция по тестированию системы хуков

## Созданные тестовые компоненты

### 1. Плагин: Test Hooks Plugin
**Расположение:** `plugins/test-hooks-plugin/`

**Демонстрирует:**
- ✅ Фильтры (Filters) - модификация данных
- ✅ События (Actions) - выполнение действий
- ✅ Условное выполнение хуков
- ✅ Приоритеты хуков
- ✅ Добавление виджетов в админку
- ✅ Добавление пунктов меню

### 2. Тема: Test Theme
**Расположение:** `themes/test-theme/`

**Демонстрирует:**
- ✅ Использование хуков в шаблонах
- ✅ Регистрация хуков в functions.php
- ✅ Интеграция с плагинами
- ✅ Отображение статистики хуков

## Шаги для тестирования

### Шаг 1: Активация темы

1. Откройте админ-панель: `http://your-domain.com/admin`
2. Перейдите в раздел **Themes** (`/admin/themes`)
3. Найдите тему **"Test Theme"**
4. Нажмите кнопку **"Активировать"**

### Шаг 2: Активация плагина

1. В админ-панели перейдите в раздел **Plugins** (`/admin/plugins`)
2. Найдите плагин **"Test Hooks Plugin"**
3. Нажмите кнопку **"Активировать"**

### Шаг 3: Проверка работы

#### 3.1. Главная панель (Dashboard)

1. Откройте главную панель админки (`/admin/dashboard`)
2. Вы должны увидеть виджет **"Test Hooks Widget"** с:
   - Статистикой хуков
   - Количеством зарегистрированных хуков
   - Информацией о вызовах хуков

#### 3.2. Меню админки

1. В боковом меню админки должен появиться пункт **"Test Hooks"** с иконкой кода

#### 3.3. Фронтенд (главная страница)

1. Откройте главную страницу сайта (`http://your-domain.com`)
2. Вы должны увидеть:
   - ✅ Бейдж **"Test Hooks Active"** в начале контента (добавлен плагином)
   - ✅ Дополнительный блок в конце контента (добавлен темой)
   - ✅ Таблицу со списком всех зарегистрированных хуков
   - ✅ Статистику вызовов хуков в сайдбаре

#### 3.4. Проверка приоритетов

На главной странице темы есть раздел **"Демонстрация приоритетов хуков"**, где показан результат работы фильтров с разными приоритетами:
- Приоритет 5: добавляет `[START]` в начало
- Приоритет 20: добавляет `[END]` в конец

Результат: `[START] Тестовый текст [END]`

## Что проверяется

### ✅ Фильтры (Filters)

1. **admin_menu** - добавление пункта меню
2. **dashboard_widgets** - добавление виджета
3. **theme_content** - модификация контента
4. **theme_title** - модификация заголовка
5. **test_priority** - демонстрация приоритетов

### ✅ События (Actions)

1. **theme_head** - добавление стилей в head
2. **theme_footer** - добавление скриптов в footer
3. **plugin_activated** - логирование активации
4. **plugin_deactivated** - логирование деактивации

### ✅ Условное выполнение

Фильтр `theme_content` в плагине выполняется только если контент не пустой.

### ✅ Приоритеты

Демонстрируется работа приоритетов 5 и 20 для фильтра `test_priority`.

## Ожидаемые результаты

### В админке:
- ✅ Виджет на главной панели
- ✅ Пункт меню "Test Hooks"
- ✅ Стили применены (виджет имеет оформление)

### На фронтенде:
- ✅ Бейдж "Test Hooks Active" в контенте
- ✅ Дополнительный блок от темы
- ✅ Таблица с хуками
- ✅ Статистика в сайдбаре
- ✅ Консольное сообщение от скрипта

## Отладка

Если что-то не работает:

1. **Проверьте логи:**
   - `storage/logs/` - системные логи
   - Консоль браузера - JavaScript ошибки

2. **Проверьте активацию:**
   - Убедитесь, что и тема, и плагин активированы
   - Проверьте в БД таблицу `plugins` - плагин должен быть активен

3. **Проверьте хуки:**
   - На главной странице темы есть таблица со всеми хуками
   - Убедитесь, что хуки зарегистрированы

4. **Очистите кеш:**
   - Перейдите в `/admin/cache`
   - Очистите кеш системы

## Дополнительная информация

- Документация по хукам: `engine/classes/system/HOOKS_DOCUMENTATION.md`
- README плагина: `plugins/test-hooks-plugin/README.md`
- README темы: `themes/test-theme/README.md`

